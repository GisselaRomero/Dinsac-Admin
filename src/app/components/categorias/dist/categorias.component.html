<div class="productos-container">


  <!-- üîç B√∫squeda -->
  <div class="busqueda-container">
<input 
  type="text" 
  [(ngModel)]="searchTerm" 
  (input)="buscar()" 
  placeholder="Buscar por c√≥digo o nombre..." 
/>
    <button (click)="buscar()">Buscar</button>
  </div>

  <!-- üóÇÔ∏è Filtro por categor√≠a -->
  <div class="category-filters mt-4">
    <h3>Filtrar por Categor√≠a</h3>
    <div class="filter-buttons">
      <button (click)="filterByCategory('all')" [class.active]="selectedCategory === 'all'">Todas</button>
      <button *ngFor="let cat of categories"
              (click)="filterByCategory(cat)"
              [class.active]="selectedCategory === cat">
        {{ cat }} ({{ getProductCountByCategory(cat) }})
      </button>
    </div>
  </div>

  <!-- üìã Tabla de productos -->
  <h2>Listado de Productos</h2>
  <table *ngIf="filteredProducts.length > 0; else noData">
    <thead>
      <tr>
        <th>C√≥digo</th>
        <th>Nombre</th>
        <th>Categor√≠a</th>
        <th>Estado</th>
        <th>Stock</th>
        <th>Im√°genes</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
<tr *ngFor="let p of paginatedProducts">
        <td>{{ p.codigo }}</td>
        <td>{{ p.name }}</td>
        <td>{{ p.category }}</td>
        <td>{{ p.estado }}</td>
        <td>{{ p.stock }}</td>
        <td>
          <ng-container *ngFor="let img of [p.image, p.image1, p.image2, p.image3]">
            <img *ngIf="img" [src]="img" width="70" class="thumb" />
          </ng-container>
        </td>
        <td>
          <button class="btn-edit" (click)="editProduct(p)">Editar</button>
          <button class="btn-delete" (click)="deleteProduct(p._id!)">Eliminar</button>
        </td>
      </tr>
    </tbody>
  </table>

  <ng-template #noData>
    <p>No hay productos disponibles.</p>
  </ng-template>

  <!-- ======================== PAGINACI√ìN ======================== -->
<div class="paginacion" *ngIf="totalPages > 1">

  <button 
    [disabled]="currentPage === 1" 
    (click)="currentPage = currentPage - 1">
    ‚¨Ö Anterior
  </button>

  <button 
    *ngFor="let page of [].constructor(totalPages); let i = index"
    [class.active]="currentPage === i + 1"
    (click)="currentPage = i + 1">
    {{ i + 1 }}
  </button>

  <button 
    [disabled]="currentPage === totalPages" 
    (click)="currentPage = currentPage + 1">
    Siguiente ‚û°
  </button>
</div>

</div>
